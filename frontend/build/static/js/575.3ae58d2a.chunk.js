"use strict";(self.webpackChunkdmgt_assessment_form=self.webpackChunkdmgt_assessment_form||[]).push([[575],{575:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var n=a(555),i=a(43),l=a(216),c=a(532),t=a(505),r=a(481),o=a(922),d=a(861),m=a(768),h=a(579);const u=()=>{var e;const{companyId:s,employeeId:a}=(0,l.g)(),u=(0,l.Zp)(),{state:v,startAssessment:p,loadQuestions:x,updateResponse:j,saveAssessment:N}=(0,c.UY)(),[g,f]=(0,i.useState)(0),[b,y]=(0,i.useState)({}),[q,k]=(0,i.useState)([]),[A,E]=(0,i.useState)(!1),[C,I]=(0,i.useState)(null),[S,w]=(0,i.useState)(!1),[L,M]=(0,i.useState)(!1),D=(0,t.c7)();(0,i.useEffect)((()=>{const e=setInterval((()=>{Object.keys(b).length>0&&!A&&P()}),3e4);return()=>clearInterval(e)}),[b,A]),(0,i.useEffect)((()=>{s&&(x("Employee"),a&&_())}),[s,a,x]);const _=async()=>{if(s&&a)try{const n=await D.getResponse("Employee",s,a);if(n&&Object.keys(n).length>0){var e;y(n);const s=(null===(e=v.questions.Employee)||void 0===e?void 0:e.questions.findIndex((e=>!n[e.id])))||0;s>=0&&f(s)}}catch(n){console.error("Failed to load previous responses:",n)}},P=(0,i.useCallback)((async()=>{if(s&&a&&0!==Object.keys(b).length){E(!0);try{await D.saveResponse({assessmentType:"Employee",companyId:s,employeeId:a,responses:b}),I(new Date)}catch(e){console.error("Auto-save failed:",e)}finally{E(!1)}}}),[s,a,b,D]),R=(e,s)=>{y((a=>(0,n.A)((0,n.A)({},a),{},{[e]:s}))),k((s=>s.filter((s=>s.field!==e))))},T=()=>{var e;const s=[];return null===(e=v.questions.Employee)||void 0===e||e.questions.forEach((e=>{const a=((e,s)=>{var a,n,i,l;if(e.required&&(void 0===s||null===s||""===s))return{field:e.id,message:"This field is required",code:"REQUIRED"};if(void 0!==s&&null!==s&&""!==s)switch(e.type){case"text":case"textarea":if(null!==(a=e.validation)&&void 0!==a&&a.minLength&&s.length<e.validation.minLength)return{field:e.id,message:"Minimum length is ".concat(e.validation.minLength," characters"),code:"MIN_LENGTH"};if(null!==(n=e.validation)&&void 0!==n&&n.maxLength&&s.length>e.validation.maxLength)return{field:e.id,message:"Maximum length is ".concat(e.validation.maxLength," characters"),code:"MAX_LENGTH"};break;case"email":if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return{field:e.id,message:"Please enter a valid email address",code:"INVALID_EMAIL"};break;case"number":case"rating":const c=Number(s);if(isNaN(c))return{field:e.id,message:"Please enter a valid number",code:"INVALID_NUMBER"};if(void 0!==(null===(i=e.validation)||void 0===i?void 0:i.min)&&c<e.validation.min)return{field:e.id,message:"Minimum value is ".concat(e.validation.min),code:"MIN_VALUE"};if(void 0!==(null===(l=e.validation)||void 0===l?void 0:l.max)&&c>e.validation.max)return{field:e.id,message:"Maximum value is ".concat(e.validation.max),code:"MAX_VALUE"}}return null})(e,b[e.id]);a&&s.push(a)})),s},U=(()=>{var e,s;const a=(null===(e=v.questions.Employee)||void 0===e?void 0:e.questions.length)||0,n=(null===(s=v.questions.Employee)||void 0===s?void 0:s.questions.filter((e=>void 0!==b[e.id])).length)||0;return{completed:n,total:a,percentage:a>0?Math.round(n/a*100):0}})(),F=(null===(e=v.questions.Employee)||void 0===e?void 0:e.questions)||[],Q=F[g],V=Q?b[Q.id]:void 0,O=q.find((e=>e.field===(null===Q||void 0===Q?void 0:Q.id)));return v.loading.questions?(0,h.jsx)("div",{className:"page-container",children:(0,h.jsx)(r.A,{size:"large",message:"Loading your employee assessment questions..."})}):0===F.length?(0,h.jsx)("div",{className:"page-container",children:(0,h.jsx)("div",{className:"card",children:(0,h.jsxs)("div",{className:"card-body",children:[(0,h.jsx)("h2",{children:"No Questions Available"}),(0,h.jsx)("p",{children:"Employee assessment questions are not available at this time."})]})})}):(0,h.jsx)("div",{className:"page-container",children:(0,h.jsxs)("div",{className:"content-container",children:[(0,h.jsxs)("div",{className:"assessment-header",children:[(0,h.jsx)("h1",{className:"heading-1",children:"Employee Assessment"}),(0,h.jsxs)("p",{className:"body-large",children:["Personal evaluation for Employee ID: ",a," at Company ID: ",s]})]}),(0,h.jsxs)("div",{className:"progress-section",children:[(0,h.jsx)(d.A,{progress:U,showDetails:!0}),(0,h.jsx)(m.A,{isSaving:A,lastSaved:C})]}),L&&q.length>0&&(0,h.jsxs)("div",{className:"card error-card",children:[(0,h.jsxs)("div",{className:"card-header",children:[(0,h.jsx)("h3",{children:"Please Complete Required Fields"}),(0,h.jsx)("button",{className:"close-btn",onClick:()=>M(!1),children:"\xd7"})]}),(0,h.jsx)("div",{className:"card-body",children:(0,h.jsx)("ul",{children:q.map(((e,s)=>{const a=F.find((s=>s.id===e.field));return(0,h.jsxs)("li",{children:[(0,h.jsxs)("strong",{children:[(null===a||void 0===a?void 0:a.title)||e.field,":"]})," ",e.message]},s)}))})})]}),Q&&(0,h.jsxs)("div",{className:"card question-card",children:[(0,h.jsxs)("div",{className:"card-header",children:[(0,h.jsxs)("div",{className:"question-header",children:[(0,h.jsxs)("span",{className:"question-number",children:["Question ",g+1," of ",F.length]}),Q.category&&(0,h.jsx)("span",{className:"question-category",children:Q.category})]}),(0,h.jsxs)("h3",{className:"question-title",children:[Q.title,Q.required&&(0,h.jsx)("span",{className:"required-indicator",children:"*"})]}),Q.description&&(0,h.jsx)("p",{className:"question-description",children:Q.description})]}),(0,h.jsx)("div",{className:"card-body",children:(0,h.jsx)(o.A,{question:Q,value:V,onChange:e=>R(Q.id,e),onFileUpload:"file"===Q.type?async(e,n)=>{if(s&&a)try{const a=await D.uploadFiles(s,e,n);R(e,a)}catch(i){console.error("File upload failed:",i)}}:void 0,error:O})})]}),(0,h.jsxs)("div",{className:"question-navigation",children:[(0,h.jsx)("button",{className:"btn btn-outline",onClick:()=>{g>0&&f(g-1)},disabled:0===g,children:"\u2190 Previous"}),(0,h.jsxs)("div",{className:"nav-info",children:[g+1," of ",F.length]}),(0,h.jsx)("button",{className:"btn btn-outline",onClick:()=>{var e;const s=(null===(e=v.questions.Employee)||void 0===e?void 0:e.questions.length)||0;g<s-1&&f(g+1)},disabled:g===F.length-1,children:"Next \u2192"})]}),(0,h.jsxs)("div",{className:"assessment-actions",children:[(0,h.jsx)("button",{className:"btn btn-outline",onClick:async()=>{await P()},disabled:A,children:A?"Saving...":"Save Progress"}),(0,h.jsx)("button",{className:"btn btn-primary",onClick:async()=>{const e=T();if(e.length>0)return k(e),void M(!0);if(s&&a){w(!0);try{await D.saveResponse({assessmentType:"Employee",companyId:s,employeeId:a,responses:b}),u("/complete/Employee/".concat(s,"/").concat(a))}catch(n){console.error("Submission failed:",n)}finally{w(!1)}}},disabled:S||U.percentage<100,children:S?"Submitting...":"Submit Assessment"})]}),(0,h.jsxs)("div",{className:"card info-card",children:[(0,h.jsx)("div",{className:"card-header",children:(0,h.jsx)("h3",{children:"Assessment Information"})}),(0,h.jsx)("div",{className:"card-body",children:(0,h.jsxs)("div",{className:"info-grid",children:[(0,h.jsxs)("div",{className:"info-item",children:[(0,h.jsx)("span",{className:"info-label",children:"Employee ID:"}),(0,h.jsx)("span",{className:"info-value",children:a})]}),(0,h.jsxs)("div",{className:"info-item",children:[(0,h.jsx)("span",{className:"info-label",children:"Company ID:"}),(0,h.jsx)("span",{className:"info-value",children:s})]}),(0,h.jsxs)("div",{className:"info-item",children:[(0,h.jsx)("span",{className:"info-label",children:"Progress:"}),(0,h.jsxs)("span",{className:"info-value",children:[U.percentage,"% Complete"]})]}),C&&(0,h.jsxs)("div",{className:"info-item",children:[(0,h.jsx)("span",{className:"info-label",children:"Last Saved:"}),(0,h.jsx)("span",{className:"info-value",children:C.toLocaleTimeString()})]})]})})]})]})})}},768:(e,s,a)=>{a.d(s,{A:()=>i});a(43);var n=a(579);const i=e=>{let{isSaving:s=!1,lastSaved:a=null,className:i=""}=e;const l=e=>{if(!e)return null;const s=new Date,a=new Date(e),n=s-a,i=Math.floor(n/1e3),l=Math.floor(i/60),c=Math.floor(l/60);return i<30?"just now":i<60?"".concat(i," seconds ago"):l<60?"".concat(l," minute").concat(1===l?"":"s"," ago"):c<24?"".concat(c," hour").concat(1===c?"":"s"," ago"):a.toLocaleDateString()+" at "+a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};return s?(0,n.jsx)("div",{className:"save-indicator saving ".concat(i),children:(0,n.jsxs)("div",{className:"save-indicator-content",children:[(0,n.jsx)("div",{className:"save-spinner",children:(0,n.jsx)("div",{className:"spinner-circle"})}),(0,n.jsx)("span",{className:"save-text",children:"Saving..."})]})}):a?(0,n.jsx)("div",{className:"save-indicator saved ".concat(i),children:(0,n.jsxs)("div",{className:"save-indicator-content",children:[(0,n.jsx)("div",{className:"save-icon",children:"\u2713"}),(0,n.jsxs)("span",{className:"save-text",children:["Saved ",l(a)]})]})}):(0,n.jsx)("div",{className:"save-indicator unsaved ".concat(i),children:(0,n.jsxs)("div",{className:"save-indicator-content",children:[(0,n.jsx)("div",{className:"save-icon",children:"\u25cb"}),(0,n.jsx)("span",{className:"save-text",children:"Not saved"})]})})}},861:(e,s,a)=>{a.d(s,{A:()=>i});a(43);var n=a(579);const i=e=>{let{progress:s,showDetails:a=!1,className:i=""}=e;const{completed:l=0,total:c=0,percentage:t=0}=s||{};return(0,n.jsxs)("div",{className:"progress-bar-container ".concat(i),children:[a&&(0,n.jsxs)("div",{className:"progress-details",children:[(0,n.jsxs)("div",{className:"progress-stats",children:[(0,n.jsx)("span",{className:"completed-count",children:l}),(0,n.jsx)("span",{className:"separator",children:"of"}),(0,n.jsx)("span",{className:"total-count",children:c}),(0,n.jsx)("span",{className:"progress-label",children:"questions completed"})]}),(0,n.jsxs)("div",{className:"progress-percentage",children:[t,"%"]})]}),(0,n.jsx)("div",{className:"progress-bar-track",children:(0,n.jsx)("div",{className:"progress-bar-fill",style:{width:"".concat(Math.min(100,Math.max(0,t)),"%"),transition:"width 0.3s ease-in-out"}})}),a&&(0,n.jsxs)("div",{className:"progress-milestones",children:[(0,n.jsxs)("div",{className:"milestone ".concat(t>=25?"completed":""),children:[(0,n.jsx)("div",{className:"milestone-marker"}),(0,n.jsx)("span",{className:"milestone-label",children:"25%"})]}),(0,n.jsxs)("div",{className:"milestone ".concat(t>=50?"completed":""),children:[(0,n.jsx)("div",{className:"milestone-marker"}),(0,n.jsx)("span",{className:"milestone-label",children:"50%"})]}),(0,n.jsxs)("div",{className:"milestone ".concat(t>=75?"completed":""),children:[(0,n.jsx)("div",{className:"milestone-marker"}),(0,n.jsx)("span",{className:"milestone-label",children:"75%"})]}),(0,n.jsxs)("div",{className:"milestone ".concat(t>=100?"completed":""),children:[(0,n.jsx)("div",{className:"milestone-marker"}),(0,n.jsx)("span",{className:"milestone-label",children:"Complete"})]})]})]})}},922:(e,s,a)=>{a.d(s,{A:()=>i});a(43);var n=a(579);const i=e=>{let{question:s,value:a,onChange:i,onFileUpload:l,error:c}=e;const t=e=>{const s=e.target.value;i(s)},r=e=>{const a=e.target.files;a&&a.length>0&&l&&l(s.id,a)},o=e=>{if("multiselect"===s.type){const s=Array.isArray(a)?a:[],n=e.target.value;e.target.checked?i([...s,n]):i(s.filter((e=>e!==n)))}else i(e.target.checked)};return(0,n.jsxs)("div",{className:"question-renderer ".concat(c?"has-error":""),children:[(()=>{var e,i,l,d;switch(s.type){case"text":case"email":case"number":return(0,n.jsx)("input",{type:s.type,value:a||"",onChange:t,placeholder:s.placeholder,className:"form-input ".concat(c?"error":""),required:s.required});case"textarea":return(0,n.jsx)("textarea",{value:a||"",onChange:t,placeholder:s.placeholder,rows:s.rows||4,className:"form-textarea ".concat(c?"error":""),required:s.required});case"select":return(0,n.jsxs)("select",{value:a||"",onChange:t,className:"form-select ".concat(c?"error":""),required:s.required,children:[(0,n.jsx)("option",{value:"",children:"Please select..."}),null===(e=s.options)||void 0===e?void 0:e.map(((e,s)=>(0,n.jsx)("option",{value:e,children:e},s)))]});case"radio":return(0,n.jsx)("div",{className:"radio-group",children:null===(i=s.options)||void 0===i?void 0:i.map(((e,i)=>(0,n.jsxs)("label",{className:"radio-label",children:[(0,n.jsx)("input",{type:"radio",name:s.id,value:e,checked:a===e,onChange:t,className:"radio-input"}),(0,n.jsx)("span",{className:"radio-text",children:e})]},i)))});case"checkbox":return(0,n.jsxs)("label",{className:"checkbox-label",children:[(0,n.jsx)("input",{type:"checkbox",checked:a||!1,onChange:o,className:"checkbox-input"}),(0,n.jsx)("span",{className:"checkbox-text",children:"Yes"})]});case"multiselect":return(0,n.jsx)("div",{className:"checkbox-group",children:null===(l=s.options)||void 0===l?void 0:l.map(((e,s)=>(0,n.jsxs)("label",{className:"checkbox-label",children:[(0,n.jsx)("input",{type:"checkbox",value:e,checked:Array.isArray(a)&&a.includes(e),onChange:o,className:"checkbox-input"}),(0,n.jsx)("span",{className:"checkbox-text",children:e})]},s)))});case"file":return(0,n.jsx)("input",{type:"file",onChange:r,accept:s.accept,multiple:s.multiple,className:"form-file ".concat(c?"error":"")});case"rating":case"scale":const m=(null===(d=s.validation)||void 0===d?void 0:d.max)||5;return(0,n.jsx)("div",{className:"rating-group",children:Array.from({length:m},((e,s)=>s+1)).map((e=>(0,n.jsxs)("label",{className:"rating-label",children:[(0,n.jsx)("input",{type:"radio",name:s.id,value:e,checked:parseInt(a)===e,onChange:t,className:"rating-input"}),(0,n.jsx)("span",{className:"rating-text",children:e})]},e)))});default:return(0,n.jsx)("input",{type:"text",value:a||"",onChange:t,placeholder:s.placeholder,className:"form-input ".concat(c?"error":""),required:s.required})}})(),c&&(0,n.jsx)("div",{className:"error-message",children:c.message})]})}}}]);
//# sourceMappingURL=575.3ae58d2a.chunk.js.map